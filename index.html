<!-- this index.html originated from an example of datamap -->
<!-- link: https://github.com/markmarkoh/datamaps/blob/master/src/examples/highmaps_world.html -->

<!DOCTYPE html>
<html>
<head>
    <style>
        .active {
          fill: blue !important;
        }
    </style>
</head>
<body>
<h1>kth dh2321 ivis17 project 2, by yiming fan</h1>
<div id="container_foo" style="border:1px dotted blue; width: 700px; height: 475px; position: relative;"></div>

<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
<script src="./src/datamaps.world.js"></script>

<script>
    // example data from server
    var series = [
      ["AUS",[0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.76,0.00,0.00,0.00,0.00,0.27,0.00,0.00,0.00,0.79,1.17,0.00,0.00,0.00,1.08,1.39,0.00,1.24,0.00,1.57,1.85,0.00,0.79,0.00,0.76,0.94,0.00,0.00,0.00,9.14,8.93]],
      ["BLR",[0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.27,0.00,0.00,0.00,0.00,0.73,1.38,0.00,-0.13,-0.30,0.71,0.00,0.00,0.00,0.00,-0.24,0.00,0.17,0.00,0.00,1.08,0.00,-0.93,0.00,0.00,-0.70,0.00,0.00,0.00,0.00,7.51]],
      ["BRA",[0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.18,0.00,0.00,0.00,0.00,0.52,-0.36,0.00,0.00,0.76,-0.69,0.00,0.00,0.00,0.66,0.73,0.00,0.00,0.00,1.26,1.40,0.00,0.00,0.00,0.54,0.61,0.00,0.00,0.00,8.46,8.46]],
      ["COL",[0.00,-0.87,0.00,0.00,0.49,0.00,0.00,0.00,0.00,-0.03,0.00,0.00,0.00,0.00,0.67,0.00,0.00,0.00,0.78,0.14,0.00,0.00,0.00,0.84,1.06,0.00,1.24,0.00,1.24,1.46,0.00,0.45,0.00,0.52,0.81,0.00,0.00,0.00,0.00,7.89]],
      ["CHN",[0.10,-0.08,-0.02,-0.10,-0.01,0.00,0.00,0.00,0.00,0.35,0.00,0.00,0.00,0.00,0.35,0.08,0.00,0.74,0.78,-0.07,0.00,0.00,0.00,0.29,0.18,0.00,0.79,1.15,0.71,0.74,0.00,-0.17,-0.08,-0.15,-0.12,0.00,0.00,0.00,8.97,8.69]],
      ["EST",[0.03,0.23,0.69,0.56,0.53,0.00,0.00,0.00,0.00,0.22,0.00,0.00,0.00,0.00,0.78,-1.55,0.00,-0.22,-0.04,1.31,0.00,0.00,0.00,0.00,0.46,0.00,0.67,0.00,0.00,1.54,0.00,-0.81,0.00,0.00,0.01,0.00,0.00,0.00,0.00,8.64]],
      ["DEU",[0.00,0.29,0.35,0.57,0.60,0.00,0.00,0.00,0.00,0.49,0.00,0.00,0.00,0.00,0.77,-0.89,0.00,-0.14,0.46,0.89,0.00,0.00,0.00,1.51,1.00,0.00,0.00,0.00,1.59,1.53,0.00,0.00,0.00,1.34,1.14,0.00,0.00,0.00,9.16,9.14]],
      ["HKG",[0.00,0.00,0.00,0.34,0.19,0.00,0.00,0.00,0.00,0.16,0.00,0.00,0.00,0.00,0.63,0.00,0.00,0.00,0.77,-1.00,0.00,0.00,0.00,0.00,0.43,0.00,0.00,0.00,0.73,0.74,0.00,0.00,0.00,0.32,0.33,0.00,0.00,0.00,0.00,7.82]],
      ["IND",[-0.03,-0.11,-0.29,-0.44,-0.39,0.00,0.00,0.00,0.00,-0.06,0.00,0.00,0.00,0.00,0.71,-1.52,0.00,0.77,0.78,-1.71,0.00,0.00,0.00,-0.61,-0.49,0.00,0.69,0.19,0.05,0.25,0.00,-0.05,-0.37,-0.55,-0.50,0.00,0.00,0.00,8.17,8.12]],
      ["JPN",[-0.15,-0.25,-0.20,-0.21,-0.36,0.00,0.00,0.00,0.00,0.23,0.00,0.00,0.00,0.00,0.80,0.00,0.00,0.73,0.79,0.83,0.00,0.00,0.00,0.43,0.38,0.00,0.28,0.77,0.66,0.75,0.00,-0.31,0.18,0.16,0.17,0.00,0.00,0.00,8.24,7.92]],
      ["KAZ",[0.00,0.00,0.00,0.00,-0.23,0.00,0.00,0.00,0.00,0.17,0.00,0.00,0.00,0.00,0.63,0.00,0.00,0.00,0.00,0.29,0.00,0.00,0.00,0.00,-0.26,0.00,0.00,0.00,0.00,0.96,0.00,0.00,0.00,0.00,-0.68,0.00,0.00,0.00,0.00,8.09]],
      ["LBN",[0.00,0.00,0.00,0.00,-0.06,0.00,0.00,0.00,0.00,-0.14,0.00,0.00,0.00,0.00,0.48,0.00,0.00,0.00,0.00,-1.36,0.00,0.00,0.00,0.00,0.20,0.00,0.00,0.00,0.00,0.77,0.00,0.00,0.00,0.00,-0.38,0.00,0.00,0.00,0.00,6.97]],
      ["MYS",[0.00,0.00,0.00,-0.53,-0.51,0.00,0.00,0.00,0.00,0.15,0.00,0.00,0.00,0.00,0.95,0.00,0.00,0.00,0.76,1.00,0.00,0.00,0.00,-0.24,-0.32,0.00,0.00,0.00,0.00,0.16,0.00,0.00,0.00,-0.74,-0.84,0.00,0.00,0.00,6.76,7.70]],
      ["MEX",[0.53,-0.60,0.25,0.46,0.61,0.00,0.00,0.00,0.00,-0.01,0.00,0.00,0.00,0.00,0.44,-0.65,0.00,0.73,0.77,-0.06,0.00,0.00,0.00,0.81,0.96,0.00,0.57,0.83,0.73,0.92,0.00,0.11,0.45,0.60,0.86,0.00,0.00,0.00,8.23,8.30]],
      ["NLD",[0.46,0.00,0.75,0.77,0.82,0.00,0.00,0.00,0.00,0.88,0.00,0.00,0.00,0.00,0.61,0.08,0.00,0.40,0.49,1.50,0.00,0.00,0.00,1.36,1.54,0.00,0.00,0.00,1.88,1.78,0.00,0.00,0.00,1.26,1.36,0.00,0.00,0.00,9.10,9.01]],
      ["NZL",[0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.19,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.91,0.00,1.00,1.09,0.00,0.00,0.00,0.00,0.00]],
      ["PAK",[0.00,-0.59,-0.57,0.00,-0.58,0.00,0.00,0.00,0.00,-0.06,0.00,0.00,0.00,0.00,-0.09,0.00,0.00,0.77,0.00,-1.31,0.00,0.00,0.00,0.00,-1.22,0.00,0.14,0.98,0.00,-0.25,0.00,-1.14,-0.20,0.00,-1.23,0.00,0.00,0.00,0.00,7.84]],
      ["PHL",[0.00,-0.39,-0.62,0.00,-0.49,0.00,0.00,0.00,0.00,0.28,0.00,0.00,0.00,0.00,0.57,0.00,0.00,0.74,0.00,-0.20,0.00,0.00,0.00,0.00,-0.06,0.00,0.41,0.33,0.00,0.12,0.00,-0.29,-0.58,0.00,-0.54,0.00,0.00,0.00,0.00,7.63]],
      ["POL",[-0.28,-0.04,0.16,0.41,0.37,0.00,0.00,0.00,0.00,0.58,0.00,0.00,0.00,0.00,0.67,0.91,0.00,-0.44,0.27,-0.78,0.00,0.00,0.00,0.60,0.67,0.00,0.48,0.00,1.06,1.11,0.00,-0.58,0.00,0.15,0.29,0.00,0.00,0.00,8.99,8.78]],
      ["ROU",[0.02,-0.04,0.11,0.21,-0.07,0.00,0.00,0.00,0.00,0.44,0.00,0.00,0.00,0.00,0.77,0.20,0.00,0.20,0.52,0.71,0.00,0.00,0.00,0.24,0.51,0.00,0.17,0.00,1.52,1.32,0.00,-1.27,0.00,-0.01,0.19,0.00,0.00,0.00,9.38,8.74]],
      ["RUS",[0.16,-0.11,0.18,0.20,0.16,0.00,0.00,0.00,0.00,0.20,0.00,0.00,0.00,0.00,0.60,-0.39,0.00,-0.33,0.54,-0.11,0.00,0.00,0.00,-0.22,-0.16,0.00,0.28,0.00,0.58,0.81,0.00,-0.53,0.00,-0.60,-0.47,0.00,0.00,0.00,9.15,8.35]],
      ["SGP",[0.00,0.00,0.28,0.00,0.09,0.00,0.00,0.00,0.00,0.22,0.00,0.00,0.00,0.00,0.56,0.00,0.00,0.72,0.00,0.20,0.00,0.00,0.00,0.00,0.34,0.00,0.00,1.02,0.00,0.78,0.00,0.00,-0.03,0.00,0.06,0.00,0.00,0.00,0.00,6.74]],
      ["KOR",[-0.20,-0.28,-0.19,-0.16,-0.16,0.00,0.00,0.00,0.00,0.22,0.00,0.00,0.00,0.00,0.73,-0.50,0.00,0.74,0.76,-0.20,0.00,0.00,0.00,0.08,0.37,0.00,0.35,1.02,0.80,1.00,0.00,-0.48,0.05,-0.19,0.16,0.00,0.00,0.00,8.06,7.61]],
      ["ESP",[0.33,0.36,0.54,0.64,0.74,0.00,0.00,0.00,0.00,0.68,0.00,0.00,0.00,0.00,0.59,0.30,0.00,0.55,0.52,0.78,0.00,0.00,0.00,1.66,1.27,0.00,1.08,1.53,1.83,1.39,0.00,0.78,1.26,1.48,1.19,0.00,0.00,0.00,8.95,8.98]],
      ["SWE",[0.83,0.84,0.96,0.96,0.96,0.00,0.00,0.00,0.00,0.72,0.00,0.00,0.00,0.00,0.19,-0.43,0.00,0.61,0.76,1.00,0.00,0.00,0.00,1.78,1.80,0.00,2.31,2.44,2.09,2.05,0.00,1.65,1.60,1.65,1.63,0.00,0.00,0.00,9.84,9.49]],
      ["TWN",[0.00,-0.84,0.00,-0.10,0.06,0.00,0.00,0.00,0.00,0.45,0.00,0.00,0.00,0.00,0.69,0.00,0.00,0.00,0.76,1.29,0.00,0.00,0.00,0.52,0.71,0.00,0.65,0.00,0.94,1.08,0.00,-0.08,0.00,0.07,0.62,0.00,0.00,0.00,9.09,8.60]],
      ["THA",[0.00,0.00,0.00,0.11,0.13,0.00,0.00,0.00,0.00,0.50,0.00,0.00,0.00,0.00,0.40,0.00,0.00,0.00,0.76,-1.67,0.00,0.00,0.00,0.10,0.42,0.00,0.00,0.00,0.70,0.70,0.00,0.00,0.00,-0.02,-0.24,0.00,0.00,0.00,7.57,8.04]],
      ["USA",[0.48,0.57,0.78,0.81,0.84,0.00,0.00,0.00,0.00,0.64,0.00,0.00,0.00,0.00,0.41,0.38,0.00,0.74,0.76,1.13,0.00,0.00,0.00,1.22,1.38,0.00,1.20,1.61,1.48,1.71,0.00,0.57,0.83,0.80,1.06,0.00,0.00,0.00,8.56,8.26]],
      ["ZWE",[0.00,0.00,0.15,0.00,0.26,0.00,0.00,0.00,0.00,-0.26,0.00,0.00,0.00,0.00,0.22,0.00,0.00,0.74,0.00,0.85,0.00,0.00,0.00,0.00,-0.03,0.00,0.00,1.32,0.00,1.16,0.00,0.00,-0.15,0.00,-0.44,0.00,0.00,0.00,0.00,6.91]]
      ];
var dm = new Datamap({
  element: document.getElementById('container_foo'),
  projection: 'mercator', // big world map
  // countries don't listed in dataset will be painted with this color
  fills: { defaultFill: '#F5F5F5' },
  //data: dataset,
  geographyConfig: {
    borderColor: '#DEDEDE',
    highlightBorderWidth: 2,
    // don't change color on mouse hover
    highlightFillColor: function(geo) {
      return geo['fillColor'] || '#F5F5F5';
    },
    // only change border
    highlightBorderColor: '#B7B7B7',
    // show desired information in tooltip
    popupTemplate: function(geo, data) {
      // don't show tooltip if country don't present in dataset
      if (!data) { return ; }
      // tooltip content
      return ['<div class="hoverinfo">',
        '<strong>', geo.properties.name, '</strong>',
        '<br>Points: <strong>', data.numberOfThings, '</strong>',
        '</div>'].join('');
    }
  }
});



function reloadData() {
  var questionValue = document.getElementById("question").value;
  var timeValue = document.getElementById("time").value;
  if (questionValue == 0 || timeValue == 0) {
    return;
  } else {
    questionValue--;
    timeValue--;
  }

  var dataset = {};
  // We need to colorize every country based on "numberOfWhatever"
  // colors should be uniq for every value.
  // For this purpose we create palette(using min/max series-value)
  var onlyValues = series.map(function(obj){
    return obj[1][questionValue*5+timeValue];
  });
  var minValue = Math.min.apply(null, onlyValues),
    maxValue = Math.max.apply(null, onlyValues);
  // create color palette function
  // color can be whatever you wish
  var paletteScale = d3.scale.linear()
    .domain([minValue,maxValue])
    .range(["#EFEFFF","#02386F"]); // blue color
  // fill dataset in appropriate format
  series.forEach(function(item){ //
    // item example value ["USA", 70]
    var iso = item[0],
      value = item[1][questionValue*5+timeValue];
    dataset[iso] = { numberOfThings: value, fillColor: paletteScale(value) };
  });
  // render map
  dm.updateChoropleth(dataset);
}

</script>
<select onchange="reloadData()" id="question">
  <option value="0">select questions</option>
  <option value="1">V45 - when jobs are scarce, men should have more right to a job than women</option>
  <option value="2">V47 - if a woman earns more money than her husband, it's almost certain to cause problems</option>
  <option value="3">V48 - having a job is the best way for a woman to be an independent person</option>
  <option value="4">V50 - when a mother works for pay, the children suffer</option>
  <option value="5">V51 - men make better business executives than women do</option>
  <option value="6">V52 - a university education is more important for a boy than for a girl</option>
  <option value="7">V53 - men make better political leaders than women do</option>
  <option value="8">V139 - democracy: women have the same rights as men</option>
</select>
<select onchange="reloadData()" id="time">
  <option value="0">select time duration</option>
  <option value="1">1990-1994</option>
  <option value="2">1995-1999</option>
  <option value="3">2000-2004</option>
  <option value="4">2005-2009</option>
  <option value="5">2010-2014</option>
</select>
<div id="container_bar" style="border:1px dotted blue; width: 700px; height: 475px; position: relative;"></div>
<script>

var dm_bar = new Datamap({
  element: document.getElementById('container_bar'),
  projection: 'mercator', // big world map
  // countries don't listed in dataset will be painted with this color
  fills: { defaultFill: '#F5F5F5' },
  //data: dataset,
  geographyConfig: {
    borderColor: '#DEDEDE',
    highlightBorderWidth: 2,
    // don't change color on mouse hover
    highlightFillColor: function(geo) {
      return geo['fillColor'] || '#F5F5F5';
    },
    // only change border
    highlightBorderColor: '#B7B7B7',
    // show desired information in tooltip
    popupTemplate: function(geo, data) {
      // don't show tooltip if country don't present in dataset
      if (!data) { return ; }
      // tooltip content
      return ['<div class="hoverinfo">',
        '<strong>', geo.properties.name, '</strong>',
        '<br>Points: <strong>', data.numberOfThings, '</strong>',
        '</div>'].join('');
    }
  }
});

</script>
</body>
</html>